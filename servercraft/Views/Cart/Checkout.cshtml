@model servercraft.Models.ViewModels.CheckoutViewModel
@{
    ViewBag.Title = "Checkout";
}

<div class="container padding-vertical">
    <h1>Checkout</h1>

    <div class="row">
        <div class="col-md-8">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Order Summary</h3>
                </div>
                <div class="panel-body">
                    @foreach (var item in Model.Items)
                    {
                        <div class="row checkout-item">
                            <div class="col-md-6">
                                <div class="media">
                                    <div class="media-left">
                                        <img class="media-object" src="@item.ImageUrl" alt="@item.Name" style="width: 64px; height: 64px;" />
                                    </div>
                                    <div class="media-body">
                                        <h4 class="media-heading">@item.Name</h4>
                                        <p>Quantity: @item.Quantity</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 text-right">
                                <p class="item-total">$@item.Total.ToString("N2")</p>
                            </div>
                        </div>
                        <hr />
                    }
                </div>
            </div>

            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Payment Method</h3>
                </div>
                <div class="panel-body">
                    @using (Html.BeginForm("ProcessPayment", "Cart", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
                    {
                        @Html.AntiForgeryToken()
                        @Html.HiddenFor(m => m.Total)

                        <div class="form-group">
                            <div class="col-md-12">
                                <div class="payment-methods">
                                    <div class="payment-method">
                                        <input type="radio" name="PaymentMethod" id="bankAccount" value="BankAccount" checked />
                                        <label for="bankAccount">
                                            <i class="fas fa-university"></i> Bank Account
                                        </label>
                                    </div>
                                    <div class="payment-method">
                                        <input type="radio" name="PaymentMethod" id="googlePay" value="GooglePay" />
                                        <label for="googlePay">
                                            <i class="fab fa-google"></i> Google Pay
                                        </label>
                                    </div>
                                    <div class="payment-method">
                                        <input type="radio" name="PaymentMethod" id="paypal" value="PayPal" />
                                        <label for="paypal">
                                            <i class="fab fa-paypal"></i> PayPal
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="bankAccountDetails" class="payment-details">
                            <div class="form-group">
                                @Html.LabelFor(m => m.BankAccount.AccountHolderName, new { @class = "control-label col-md-3" })
                                <div class="col-md-9">
                                    @Html.TextBoxFor(m => m.BankAccount.AccountHolderName, new { @class = "form-control" })
                                </div>
                            </div>
                            <div class="form-group">
                                @Html.LabelFor(m => m.BankAccount.BankName, new { @class = "control-label col-md-3" })
                                <div class="col-md-9">
                                    @Html.TextBoxFor(m => m.BankAccount.BankName, new { @class = "form-control" })
                                </div>
                            </div>
                            <div class="form-group">
                                @Html.LabelFor(m => m.BankAccount.AccountNumber, new { @class = "control-label col-md-3" })
                                <div class="col-md-9">
                                    @Html.TextBoxFor(m => m.BankAccount.AccountNumber, new { @class = "form-control" })
                                </div>
                            </div>
                            <div class="form-group">
                                @Html.LabelFor(m => m.BankAccount.RoutingNumber, new { @class = "control-label col-md-3" })
                                <div class="col-md-9">
                                    @Html.TextBoxFor(m => m.BankAccount.RoutingNumber, new { @class = "form-control" })
                                </div>
                            </div>
                        </div>

                        <div id="googlePayDetails" class="payment-details" style="display: none;">
                            <div class="alert alert-info">
                                <i class="fab fa-google"></i> You will be redirected to Google Pay to complete your payment.
                            </div>
                        </div>

                        <div id="paypalDetails" class="payment-details" style="display: none;">
                            <div class="alert alert-info">
                                <i class="fab fa-paypal"></i> You will be redirected to PayPal to complete your payment.
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="col-md-12 text-right">
                                <button type="submit" class="btn btn-primary btn-lg">Complete Purchase</button>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">Order Total</h3>
                </div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-md-6">Subtotal</div>
                        <div class="col-md-6 text-right">$@Model.Subtotal.ToString("N2")</div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">Shipping</div>
                        <div class="col-md-6 text-right">$@Model.Shipping.ToString("N2")</div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">Tax</div>
                        <div class="col-md-6 text-right">$@Model.Tax.ToString("N2")</div>
                    </div>
                    <hr />
                    <div class="row">
                        <div class="col-md-6"><strong>Total</strong></div>
                        <div class="col-md-6 text-right"><strong>$@Model.Total.ToString("N2")</strong></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section scripts {
    <script>
        $(document).ready(function() {
            $('input[name="PaymentMethod"]').change(function() {
                $('.payment-details').hide();
                $('#' + $(this).val().toLowerCase() + 'Details').show();
            });
        });
    </script>
}

<style>
.payment-methods {
    display: flex;
    gap: 20px;
    margin-bottom: 20px;
}

.payment-method {
    flex: 1;
    text-align: center;
}

.payment-method input[type="radio"] {
    display: none;
}

.payment-method label {
    display: block;
    padding: 15px;
    border: 2px solid #ddd;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.payment-method label:hover {
    border-color: #007bff;
}

.payment-method input[type="radio"]:checked + label {
    border-color: #007bff;
    background-color: #f8f9fa;
}

.payment-method i {
    font-size: 24px;
    margin-bottom: 8px;
    display: block;
}

.checkout-item {
    margin-bottom: 15px;
}

.item-total {
    font-size: 18px;
    font-weight: bold;
    margin: 0;
}

.panel {
    margin-bottom: 30px;
}

.panel-title {
    font-size: 18px;
    font-weight: 600;
}
</style> 